# æ•°æ®æ¸…æ´—è„šæœ¬ (Data Cleaner)

## åŠŸèƒ½æ¦‚è¿°

æ•°æ®æ¸…æ´—è„šæœ¬æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºå¤„ç†å·²åˆ†ç±»æ—¥å¿—æ•°æ®çš„å·¥å…·ï¼Œä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š

1. **å»é™¤"other"ç±»åˆ«** - è‡ªåŠ¨è¿‡æ»¤æ‰æ ‡è®°ä¸º"other"çš„æ—¥å¿—æ¡ç›®
2. **æ•°æ®å¹³è¡¡** - æ§åˆ¶æ¯ç±»åˆ«çš„æ•°æ®é‡ï¼Œé¿å…æ•°æ®åæ–œ
3. **ç”Ÿæˆè®­ç»ƒæ•°æ®é›†** - åˆ›å»ºé€‚åˆæœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒçš„æ•°æ®æ ¼å¼
4. **æ”¯æŒå¤šç§æ•°æ®æ ¼å¼** - è‡ªåŠ¨æ£€æµ‹ä¸åŒçš„åˆ—åå’Œæ•°æ®ç»“æ„
5. **æ‰¹é‡å¤„ç†** - æ”¯æŒå¤„ç†å¤šä¸ªæ•°æ®æ–‡ä»¶å¹¶åˆå¹¶

## ä¸»è¦ç‰¹æ€§

### è‡ªåŠ¨åˆ—æ£€æµ‹
è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹ä»¥ä¸‹åˆ—åï¼š
- **æ ‡ç­¾åˆ—**: `content_type`, `final_label`, `label`, `category`
- **æ–‡æœ¬åˆ—**: `original_log`, `message`, `content`, `text`

### æ•°æ®å¹³è¡¡
- æ”¯æŒè®¾ç½®æ¯ç±»åˆ«æœ€å¤§æ•°æ®é‡ï¼ˆé»˜è®¤500æ¡ï¼‰
- é¿å…æŸäº›ç±»åˆ«æ•°æ®è¿‡å¤šå¯¼è‡´æ¨¡å‹åæ–œ
- ä¿æŒå„ç±»åˆ«æ•°æ®ç›¸å¯¹å‡è¡¡

### è¾“å‡ºæ ¼å¼
- **æ¸…æ´—æ•°æ®**: ä¿ç•™æ‰€æœ‰åˆ—ï¼Œä»…è¿‡æ»¤otherç±»åˆ«
- **è®­ç»ƒæ•°æ®**: åªä¿ç•™æ–‡æœ¬å’Œæ ‡ç­¾åˆ—ï¼Œé‡å‘½åä¸º`text`å’Œ`label`

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ç”¨æ³•

```bash
# å¤„ç†DATA_OUTPUTç›®å½•ä¸‹çš„æ‰€æœ‰CSVæ–‡ä»¶å¹¶åˆ›å»ºåˆå¹¶æ•°æ®é›†
python data_cleaner.py --combined

# å¤„ç†æŒ‡å®šæ–‡ä»¶
python data_cleaner.py your_file.csv

# è®¾ç½®æ¯ç±»æœ€å¤šä¿ç•™æ¡æ•°
python data_cleaner.py --combined --max-per-class 300

# æŒ‡å®šè¾“å‡ºç›®å½•
python data_cleaner.py --combined --output-dir my_output
```

### Windowsæ‰¹å¤„ç†è„šæœ¬

```bash
# ä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬ï¼ˆæ¨èï¼‰
batch-scripts/run_data_cleaner.bat
```

## è¾“å‡ºæ–‡ä»¶

### åˆå¹¶æ•°æ®é›†æ¨¡å¼
è„šæœ¬ä¼šç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š

1. **åˆå¹¶æ•°æ®é›†** - `combined_dataset_{æ—¶é—´æˆ³}.csv`
   - åŒ…å«æ‰€æœ‰é"other"ç±»åˆ«çš„æ•°æ®
   - æŒ‰ç±»åˆ«å¹³è¡¡åçš„æ•°æ®

2. **è®­ç»ƒæ•°æ®é›†** - `training_dataset_{æ—¶é—´æˆ³}.csv`
   - åªåŒ…å«`text`å’Œ`label`åˆ—
   - é€‚åˆæœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒ

### å•æ–‡ä»¶å¤„ç†æ¨¡å¼
è„šæœ¬ä¼šä¸ºæ¯ä¸ªè¾“å…¥æ–‡ä»¶ç”Ÿæˆï¼š
- `{åŸæ–‡ä»¶å}_cleaned_{æ—¶é—´æˆ³}.csv` - æ¸…æ´—åçš„æ•°æ®
- `{åŸæ–‡ä»¶å}_training_{æ—¶é—´æˆ³}.csv` - è®­ç»ƒæ•°æ®

## å®é™…ç¤ºä¾‹

### è¾“å…¥æ•°æ®
```csv
line_number,log_level,content_type,priority,manual_annotation_needed,original_log
1,UNKNOWN,stack_exception,1,True,"Exception in thread main..."
2,ERROR,connection_issue,2,True,"Connection timeout..."
3,INFO,other,999,False,"Normal log message..."
```

### è¾“å‡ºæ•°æ®
```csv
text,label
"Exception in thread main...",stack_exception
"Connection timeout...",connection_issue
```

### å¤„ç†è¿‡ç¨‹ç¤ºä¾‹

```
ğŸ”„ åˆ›å»ºåˆå¹¶æ•°æ®é›†...
ğŸ“Š åŠ è½½æ•°æ®: 1509 æ¡è®°å½•
  âœ“ connection_issue_è¿æ¥é—®é¢˜_20250802_011450.csv: 1509 æ¡è®°å½•
ğŸ“Š åŠ è½½æ•°æ®: 1143 æ¡è®°å½•
  âœ“ monitoring_heartbeat_ç›‘æ§å¿ƒè·³_20250802_011450.csv: 969 æ¡è®°å½•

ğŸ“Š åˆå¹¶åæ€»æ•°æ®: 153468 æ¡è®°å½•
âš–ï¸ å¹³è¡¡åæ•°æ®: 4764 æ¡è®°å½•
ğŸ’¾ å·²ä¿å­˜åˆå¹¶æ•°æ®é›†åˆ°: DATA_OUTPUT\combined_dataset_20250802_013437.csv
ğŸ’¾ å·²ä¿å­˜è®­ç»ƒæ•°æ®åˆ°: DATA_OUTPUT\training_dataset_20250802_013437.csv

ğŸ“ˆ æœ€ç»ˆç±»åˆ«åˆ†å¸ƒ:
  auth_authorization: 500 æ¡ (10.5%)
  business_logic: 500 æ¡ (10.5%)
  config_environment: 500 æ¡ (10.5%)
  connection_issue: 500 æ¡ (10.5%)
  database_exception: 500 æ¡ (10.5%)
  memory_performance: 500 æ¡ (10.5%)
  monitoring_heartbeat: 500 æ¡ (10.5%)
  normal_operation: 500 æ¡ (10.5%)
  stack_exception: 500 æ¡ (10.5%)
  spring_boot_startup_failure: 258 æ¡ (5.4%)
  timeout: 6 æ¡ (0.1%)
```

## å‚æ•°è¯´æ˜

- `--combined`: åˆ›å»ºåˆå¹¶çš„æ•°æ®é›†ï¼ˆæ¨èï¼‰
- `--max-per-class N`: æ¯ç±»åˆ«æœ€å¤šä¿ç•™Næ¡æ•°æ®ï¼ˆé»˜è®¤500ï¼‰
- `--output-dir PATH`: æŒ‡å®šè¾“å‡ºç›®å½•ï¼ˆé»˜è®¤DATA_OUTPUTï¼‰
- `input_file`: æŒ‡å®šè¦å¤„ç†çš„å•ä¸ªæ–‡ä»¶

## ç±»åˆ«æ”¯æŒ

è„šæœ¬æ”¯æŒä»¥ä¸‹æ—¥å¿—ç±»åˆ«ï¼š
- `stack_exception` - å †æ ˆå¼‚å¸¸
- `spring_boot_startup_failure` - Spring Bootå¯åŠ¨å¤±è´¥
- `auth_authorization` - è®¤è¯æˆæƒ
- `database_exception` - æ•°æ®åº“å¼‚å¸¸
- `connection_issue` - è¿æ¥é—®é¢˜
- `timeout` - è¶…æ—¶é”™è¯¯
- `memory_performance` - å†…å­˜æ€§èƒ½
- `config_environment` - é…ç½®ç¯å¢ƒ
- `business_logic` - ä¸šåŠ¡é€»è¾‘
- `normal_operation` - æ­£å¸¸æ“ä½œ
- `monitoring_heartbeat` - ç›‘æ§å¿ƒè·³

## æ³¨æ„äº‹é¡¹

1. è„šæœ¬ä¼šè‡ªåŠ¨è¿‡æ»¤æ‰`content_type`ä¸º"other"çš„æ¡ç›®
2. å¦‚æœæŸç±»åˆ«æ•°æ®é‡ä¸è¶³ï¼Œä¼šä¿ç•™æ‰€æœ‰å¯ç”¨æ•°æ®
3. æ‰€æœ‰è¾“å‡ºæ–‡ä»¶éƒ½ä½¿ç”¨UTF-8ç¼–ç 
4. æ—¶é—´æˆ³æ ¼å¼ä¸º`YYYYMMDD_HHMMSS`
5. å»ºè®®ä½¿ç”¨`--combined`æ¨¡å¼å¤„ç†å¤šä¸ªæ–‡ä»¶

## é”™è¯¯å¤„ç†

- å¦‚æœè¾“å…¥æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ ¼å¼é”™è¯¯ï¼Œè„šæœ¬ä¼šæ˜¾ç¤ºç›¸åº”çš„é”™è¯¯ä¿¡æ¯
- å¦‚æœç¼ºå°‘å¿…è¦çš„åˆ—ï¼Œè„šæœ¬ä¼šæç¤ºå¹¶é€€å‡º
- æ‰€æœ‰é”™è¯¯éƒ½ä¼šåœ¨æ§åˆ¶å°æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ 